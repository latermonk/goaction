# .github/workflows/go.yml
name: Go CI

on:
  push:
    branches:
      - main  # 当代码推送到 main 分支时触发工作流

jobs:
  build:
    runs-on: ubuntu-latest  # 使用最新的 Ubuntu 系统作为运行环境

    steps:
      - name: Checkout code
        uses: actions/checkout@v3  # 检出代码到运行环境

      - name: Set up Go
        uses: actions/setup-go@v4  # 设置 Go 环境
        with:
          go-version: '1.20'  # 指定 Go 的版本

      - name: Build
        run: go build -v ./...  # 编译项目
#
#      - name: Run tests
#        run: go test -v ./...  # 运行测试（虽然这个示例没有测试代码，但保留该步骤作为通用模板）

      - name: Set up Goreleaser
        uses: goreleaser/goreleaser-action@v4
        with:
          version: latest
          distribution: goreleaser
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Release
        run: goreleaser release --rm-dist

      - name: Run Hello World
        run: go run main.go  # 运行 Hello World 程序